{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 40c2c0821a81ba2aec6e","webpack:///./src/index.js","webpack:///./node_modules/uuid/v1.js","webpack:///./node_modules/uuid/lib/rng-browser.js","webpack:///./node_modules/uuid/lib/bytesToUuid.js"],"names":["TARGET","handlers","listeners","setTarget","target","Error","postmessage","uuid","type","origin","key","data","postMessage","request","callback","UUID","get","addListener","once","cb","res","index","indexOf","splice","push","response","activate","window","addEventListener","e","forEach","source"],"mappings":"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A,QACxBE,GADwB,WACxBA,GADwB;AAAA,QACnBH,IADmB,WACnBA,IADmB;AAAA,QACbI,IADa,WACbA,IADa;AAEtC;;AACA,QAAIH,SAAS,SAAT,IAAsBN,UAAUQ,GAAV,CAA1B,EAA0C;AACxC;AACAR,gBAAUQ,GAAV,EAAeoB,OAAf,CAAuB,cAAM;AAC3B,YAAI,OAAOX,EAAP,KAAc,UAAlB,EAA8B;AAC5B;AACA;AACA,cAAIV,SAASoB,EAAEpB,MAAF,IAAYoB,EAAEpB,MAAF,KAAa,MAAzB,GAAkC,GAAlC,GAAwCoB,EAAEpB,MAAvD;AACAU,aAAGR,IAAH,EAAS;AAAA,mBAAOc,SAASlB,IAAT,EAAesB,EAAEE,MAAjB,EAAyBX,GAAzB,EAA8BX,MAA9B,CAAP;AAAA,WAAT;AACD;AACF,OAPD;AAQD;AACD;AACA,QAAID,SAAS,UAAT,IAAuB,OAAOP,SAASM,IAAT,CAAP,KAA0B,UAArD,EAAiE;AAC/D;AACAN,eAASM,IAAT,EAAeI,IAAf;AACD;AACF,GAnBD;AAoBD;;AAED;AACAe;;AAEA,+DAAe;AACbb,kBADa;AAEbG,UAFa;AAGbC,0BAHa;AAIbd;AAJa,CAAf,E;;;;;;ACvGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,mCAAmC;AACnC;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,iBAAiB,OAAO;AACxB;AACA;;AAEA;AACA;;AAEA;;;;;;;AC5GA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iCAAiC;;AAEjC;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAsB,QAAQ;AAC9B;AACA;AACA;;AAEA;AACA;AACA;;;;;;;AC/BA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"iframe-pmtp\"] = factory();\n\telse\n\t\troot[\"iframe-pmtp\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 40c2c0821a81ba2aec6e","import UUID from 'uuid/v1'\n\n// 需要请求的目标\nlet TARGET\n\n// 保存发送请求之后的回调函数\nconst handlers = {}\n\n// 保存收到请求之后的回调函数\nconst listeners = {}\n\n// 指定目标\nfunction setTarget (target) {\n  if (!target) {\n    throw new Error('The target should be a window object')\n  }\n  TARGET = target\n}\n\n// 发送 postmessage，type 决定了收到 postmessage 后是否需要返回\nfunction postmessage ({ uuid, target, type, origin, key, data }) {\n  target.postMessage({\n    uuid,\n    type,\n    key,\n    data\n  }, origin)\n}\n\n// 发送请求\nfunction request (key, data = {}, callback, target = TARGET, origin = '*') {\n  // 如果没有设置 target 的话，抛出错误\n  if (!target) {\n    throw new Error('You must set a target by \"setTarget\" method Or the fourth parameter')\n  }\n  // 生成唯一标识符 uuid\n  const uuid = UUID()\n  // 发送 postmessage\n  postmessage({ uuid, target, type: 'request', key, data, origin })\n  // 注册相应回调函数\n  if (callback && typeof callback === 'function') {\n    handlers[uuid] = (data) => {\n      callback(data)\n      delete handlers[uuid]\n    }\n  }\n}\n\n// 单纯请求数据，不发送数据\nfunction get (key, callback, target = TARGET, origin = '*') {\n  request(key, {}, callback, target, origin)\n}\n\n// 添加收到请求的回调函数\nfunction addListener (key, callback, once = false) {\n  if (typeof callback !== 'function') {\n    throw new Error('The second argument of function \"addListener\" should be a \"Function\"')\n  }\n  let cb = callback\n  listeners[key] = listeners[key] || []\n  // 如果是一次性回调\n  if (once) {\n    cb = (data, res) => {\n      callback(data, res)\n      const index = listeners[key].indexOf(cb)\n      listeners[key].splice(index, 1)\n    }\n  }\n  listeners[key].push(cb)\n}\n\n// 返回响应\nfunction response (uuid, target, data, origin) {\n  postmessage({ uuid, target, type: 'response', data, origin })\n}\n\n// 启动监听\nfunction activate () {\n  window.addEventListener('message', e => {\n    const { type, key, uuid, data } = e.data\n    // 如果是请求\n    if (type === 'request' && listeners[key]) {\n      // 顺序执行所有已注册的回调\n      listeners[key].forEach(cb => {\n        if (typeof cb === 'function') {\n          // 如果可以取到请求的源，则直接返回给源\n          // 不行的话就直接给个通配符\n          let origin = e.origin && e.origin === 'null' ? '*' : e.origin\n          cb(data, res => response(uuid, e.source, res, origin))\n        }\n      })\n    }\n    // 如果是返回\n    if (type === 'response' && typeof handlers[uuid] === 'function') {\n      // 执行相应的回调\n      handlers[uuid](data)\n    }\n  })\n}\n\n// 执行监听\nactivate()\n\nexport default {\n  request,\n  get,\n  addListener,\n  setTarget\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\nvar _clockseq;\n\n// Previous uuid creation time\nvar _lastMSecs = 0;\nvar _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n  if (node == null || clockseq == null) {\n    var seedBytes = rng();\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [\n        seedBytes[0] | 0x01,\n        seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]\n      ];\n    }\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  }\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/v1.js\n// module id = 1\n// module chunks = 0","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && msCrypto.getRandomValues.bind(msCrypto));\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/lib/rng-browser.js\n// module id = 2\n// module chunks = 0","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/lib/bytesToUuid.js\n// module id = 3\n// module chunks = 0"],"sourceRoot":""}